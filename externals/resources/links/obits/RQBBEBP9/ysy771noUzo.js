/*!CK:1462757832!*//*1383661128,178191153*/

if (self.CavalryLogger) { CavalryLogger.start_js(["iwLf3"]); }

__d("OpenIDRequest",["AsyncRequest","AsyncSignal","URI","UserAgent","PHPQuerySerializer","coalesce","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('AsyncSignal'),i=b('URI'),j=b('UserAgent'),k=b('PHPQuerySerializer'),l=b('coalesce'),m=b('copyProperties'),n=b('createArrayFrom');function o(){var p=new g().setReadOnly(true).setHandler(this.asyncResponseHandler.bind(this)).setErrorHandler(this.asyncErrorHandler.bind(this));m(this,{openidUrl:null,requestId:o.maxRequestId++,successResponseHandler:null,cancelHandler:null,intermediateHandler:null,immediateMode:false,useExtensions:true,thirdPartyLogin:false,popupWindow:null,asyncRequest:p,retryCount:0});o.requests[this.requestId]=this;}o.getRequestById=function(p){return o.requests[p];};o.prototype.setOpenIDUrl=function(p){this.openidUrl=p;return this;};o.prototype.setSuccessHandler=function(p){this.successResponseHandler=p;return this;};o.prototype.setErrorHandler=function(p){this.errorHandler=p;return this;};o.prototype.setCancelHandler=function(p){this.cancelHandler=p;return this;};o.prototype.setImmediateMode=function(p){this.immediateMode=p;return this;};o.prototype.setUseExtensions=function(p){this.useExtensions=p;return this;};o.prototype.setIntermediateHandler=function(p){this.intermediateHandler=p;return this;};o.prototype.setThirdPartyLogin=function(p){this.thirdPartyLogin=p;return this;};o.prototype.send=function(){if(!this.openidUrl)throw "openidUrl is a required parameter. Call setOpenIDUrl()";var p=this.calculateRedirectUrl();if(!p){this.logMetrics('redirectUrlNotFound');return;}if(this.immediateMode){this.createHiddenIframe(p);}else{if(this.popupWindow)throw "OpenID popup is already in progress";this.showPopup(p);}this.logMetrics('requestSent');};o.prototype.calculateRedirectUrl=function(p){var q=this.immediateMode?'checkid_immediate':'checkid_setup',r={'openid.mode':q},s;if(!o.cache[this.openidUrl])return null;s=o.cache[this.openidUrl].url;var t=i(i(s).getQueryData()['openid.return_to']);t.addQueryData({context:o.context,request_id:this.requestId});r['openid.return_to']=t.toString();r.third_party_login=this.thirdPartyLogin;return i(s).addQueryData(r).getQualifiedURI();};o.prototype.createHiddenIframe=function(p){var q='openid_request_'+this.requestId,r=document.body.appendChild(document.createElement('div')),s=function(){r.innerHTML=('<iframe name="'+q+'"'+' src="'+p.toString()+'"'+' scrolling="no" '+' frameborder="0" class="hidden_elem"></iframe>');};if(j.ie()){r.innerHTML='<iframe src="javascript:false"></iframe>';s.defer();}else s();};o.prototype.showPopup=function(p){var q;if(o.cache[this.openidUrl])q=o.cache[this.openidUrl].popup_dimensions;if(!q||!q.height||!q.width)q={height:'580',width:'790'};var r={x:l(window.screenX,window.screenLeft),y:l(window.screenY,window.screenTop),width:l(window.outerWidth,document.body.clientWidth),height:l(window.outerHeight,document.body.clientHeight)},s=r.x+((r.width-q.width)/2),t=r.y+((r.height-q.height)/2),u=["location=yes","scrollbars=1","left="+s,"top="+t,"resizable=yes","height="+q.height,"width="+q.width].join(",");this.popupWindow=window.open(p.toString(),'_blank',u);this.popupPollInterval=setInterval(this.pollPopupWindow.bind(this),100);this.popupWindow.focus();};o.prototype.pollPopupWindow=function(){if(!(this.popupPollInterval&&this.popupWindow))return;if(this.popupWindow.closed){clearInterval(this.popupPollInterval);this.cancel();}};o.prototype.closePopupIfOpen=function(){if(this.popupWindow){if(this.popupPollInterval)clearInterval(this.popupPollInterval);this.popupWindow.close();}this.popupWindow=null;};o.prototype.cancel=function(){this.closePopupIfOpen();if(this.cancelHandler)this.cancelHandler();this.logMetrics('requestCanceled');};o.prototype.logMetrics=function(p){new h('/ajax/openid/metrics.php',{metric:p,immediate:this.immediateMode,context:o.context,openid_url:this.openidUrl}).send();};o.prototype.triggerCompleteAuthAsync=function(p){if(p.charAt(0)=='?'||p.charAt(0)=='&')p=p.substr(1);var q=k.deserialize(p);this.closePopupIfOpen();if(q['openid.mode']=='cancel'){this.cancel();return;}if(this.intermediateHandler)this.intermediateHandler();this.asyncRequest.setData({openid_params:q}).send();};o.prototype.asyncResponseHandler=function(p){var q=p.getPayload();if(this.successResponseHandler)this.successResponseHandler(q);this.closePopupIfOpen();};o.prototype.cleanHandleResponse=function(p){if(p.css)p.css=n(p.css);this.asyncRequest.handleResponse(p);};o.prototype.asyncErrorHandler=function(p){this.closePopupIfOpen();if(p.error==1428010||p.error==1428011){this.cancel();return;}if(this.errorHandler)this.errorHandler(p);};o.prototype.retry=function(){++this.retryCount;this.requestId=o.maxRequestId++;this.send();};o.prototype.setProviderCache=function(p){o.cache=p;return this;};o.cache={};o.requests=[];o.maxRequestId=0;o.context='default';e.exports=o;});
__d("WidgetArbiter",["createArrayFrom"],function(a,b,c,d,e,f){var g=b('createArrayFrom'),h={_findSiblings:function(){if(h._siblings)return;h._siblings=[];for(var i=parent.frames.length-1;i>=0;i--)try{if(parent.frames[i]&&parent.frames[i].Arbiter&&parent.frames[i].Arbiter.inform)h._siblings.push(parent.frames[i].Arbiter);}catch(j){}},inform:function(){h._findSiblings();var i=g(arguments);h._siblings.forEach(function(j){j.inform.apply(j,i);});}};e.exports=h;});
__d("PlatformOptInPopup",["PopupWindow","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('PopupWindow'),h=b('URI'),i=b('copyProperties'),j=function(){};i(j,{DIALOG_URL:'/connect/uiserver.php',DIALOG_WIDTH:420,DIALOG_HEIGHT:450,APP_ID:127760087237610,open:function(k,l,m){if(!k)k='generic';if(!l)l='plugin.optin';var n=new h(j.DIALOG_URL);n.addQueryData({social_plugin:k,method:l,display:'popup',secure:h.getRequestURI().isSecure(),app_id:j.APP_ID});if(m)n.addQueryData(m);return g.open(n.toString(),j.DIALOG_WIDTH,j.DIALOG_HEIGHT);}});e.exports=j;});
__d("Feedback",["AsyncRequest","CSS","Dialog","DOM","Event","Input","LegacyContextualDialog","MentionsInput","Parent","PlatformOptInPopup","Style","Vector","$","tx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('Event'),l=b('Input'),m=b('LegacyContextualDialog'),n=b('MentionsInput'),o=b('Parent'),p=b('PlatformOptInPopup'),q=b('Style'),r=b('Vector'),s=b('$'),t=b('tx'),u={comments:{},registerComment:function(v,w){u.comments[v]=w;return u;},getRegisteredComment:function(v){return u.comments[v];},deleteClickHandler:function(v,w,x,y,z,aa){var ba=new i().setTitle("Delete post?").setBody("Are you sure you want to delete this post?").setButtons([i.newButton('delete',"Delete"),i.CANCEL]).setHandler(function(event){new g().setURI('/ajax/connect/feedback.php').setData({command:'delete',url:v,uniqid:y,owns_pages:z,controller_id:x,locale:aa,comment_id:w}).send();}.bind(this)).show();},resizeCommentas:function(v){var w=j.scry(v,'div.post')[0];if(w){var x=r.getElementDimensions(w).x;if(x){var y=j.find(w,'.commentas'),z=r.getElementDimensions(y).x;if((x-z)<190&&(x-190)>60){q.set(y,'width',x-190+'px');var aa=j.scry(y,'span.commentas_inner')[0];if(aa){var ba=r.getElementDimensions(aa).x;q.set(y,'width',ba+'px');}}}}},exposeContextualDialogReply:function(v){var w=s(v),x=w.parentNode.parentNode;h.show(j.find(x,"form"));j.find(x,"textarea").focus();return false;},concealContextualDialogReply:function(v){var w=s(v),x=w.parentNode.parentNode,y=j.find(x,"form"),z=j.find(x,"textarea"),aa=z.value.length;if(!l.getValue(z))h.hide(y);return false;},closeContextualDialog:function(v){var w=m.getInstance(s(v));w.hide();return false;},_clickLocked:false,attachOptInClickListener:function(v){k.listen(v,'click',function(w){k.kill(w);if(!this._clickLocked){this._clickLocked=true;setTimeout(function(){this._clickLocked=false;}.bind(this),1000);p.open('feedback','plugin.optin');}});},attachReplyListener:function(v){if(!v)return;var w=j.find(v,'textarea');v.suppressBlur=false;k.listen(v,'click',function(x){var y=x.getTarget(),z=o.byClass(y,'commentas')!==null,aa=o.byClass(y,'uiButton')!==null,ba=o.byClass(y,'uiSelector')!==null;v.suppressBlur=z||aa||ba;});k.listen(w,'blur',function(x,y){if(v.interval)return;v.interval=setInterval((function(z,aa){if(z.suppressBlur||l.getValue(aa)||aa==document.activeElement)return;h.hide(z);z.suppressBlur=false;clearInterval(z.interval);delete z.interval;}).curry(v,x),100);}.curry(w));},attachReplyClickListener:function(v,w,x){if(!v)return;var y=j.find(v,'textarea');k.listen(w,'click',function(z){h.show(v);y.focus();(function(){var aa=n.getInstance(y);if(!x.isViewer&&x.isReply)if(aa){var ba=aa.getMentions();if(!ba[x.uid]&&l.getValue(y)==='')aa.addMention(x);}else l.setValue(y,x.text+' ');z.preventDefault();}).bind(this).defer();});},resetInput:function(v){var w=n.getInstance(v);if(w){w.reset();}else l.setValue(v,'');}};e.exports=a.Feedback||u;});
__d("CommentAdminPanelController",["Arbiter","AsyncRequest","Button","ChannelConstants","CSS","DOM","Event","Feedback","Parent","Toggler","XD","URI","Vector","$","copyProperties","ge","startsWith","MultiLoginPopup"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Button'),j=b('ChannelConstants'),k=b('CSS'),l=b('DOM'),m=b('Event'),n=b('Feedback'),o=b('Parent'),p=b('Toggler'),q=b('XD').UnverifiedXD,r=b('URI'),s=b('Vector'),t=b('$'),u=b('copyProperties'),v=b('ge'),w=b('startsWith'),x=function(y){u(this,{locale:y.locale,channel:y.channel,controllerID:y.controllerID,commentIDs:y.commentIDs,domIDs:y.domIDs,duplicateComments:[],fetchMoreCommentsIsPending:{},blacklistedActors:y.blacklistedActors,actorToCommentInfoMap:y.actorToCommentIDMap,commentInfoMap:y.commentInfoMap,inAggregatedView:y.inAggregatedView,inModerationQueue:y.inModerationQueue,inContextualDialog:y.inContextualDialog,isTopLevelCommentPollingEnabled:false,loggedIn:y.loggedIn,newestCommentTimestamp:y.newestCommentTimestamp,realTimePollingParams:{},userOwnsPages:y.userOwnsPages,recentlyBlacklistedActors:y.blacklistedActors});g.subscribe(j.getArbiterType('comments_plugin_new_post'),function(z,aa){if(aa.obj.target===this.realTimePollingParams.target){if(v(aa.obj.comment_element_id))return;var ba=u({},this.realTimePollingParams);ba.post_fbid=aa.obj.post_fbid;var ca=aa.obj.parent_comment_id;if(ca){var da=v(ca);if(!da)return;var ea=l.scry(da,'.fbFeedbackPager.uiMorePager');if(ea.length>0)return;ba.parent_comment_id=ca;ba.is_reply_thread=true;}else{if(!this.isTopLevelCommentPollingEnabled)return;ba.is_reply_thread=false;}this.pollForComments(ba);}}.bind(this));this.controlledRegion=t(this.controllerID);this.attachClickHandlers();if(this.inModerationQueue)this.registerModeratorQueueHandlers(true);if(this.inContextualDialog)this.attachContextualDialogHandlers();if(!this.inAggregatedView)q.init({autoResize:true,channelUrl:y.channel,hideOverflow:true,resizeWidth:false});};u(x,{allControllers:{},mainController:null,contextualControllers:{},initController:function(y){var z=new x(y),aa=y.controllerID;x.allControllers[aa]=z;if(z.inContextualDialog){x.contextualControllers[aa]=z;}else x.mainController=z;},syncController:function(y,z){var aa=x.allControllers[y];aa.attachClickHandlers();if(!aa.isControllingModerationQueue())return;aa.deselectComments(z);aa.registerModeratorQueueHandlers(false);aa.synchronizeModeratorQueueUI();},resetController:function(y){var z=x.allControllers[y];z.resetController();},appendComments:function(y,z,aa){var ba=x.allControllers[y];ba.appendComments(z,aa);},prependComments:function(y,z,aa){var ba=x.allControllers[y];ba.prependComments(z,aa);},updateController:function(y,z,aa,ba,ca,da,ea){var fa=x.allControllers[y];fa.updateController(z,aa,ba,ca,da,ea);if(!x.mainController.loggedIn)b('MultiLoginPopup').reattachLoginInterceptors();if(!fa.isControllingModerationQueue())return;fa.registerModeratorQueueHandlers(false);fa.synchronizeModeratorQueueUI();},updatePollingParamsCommentas:function(y,z){var aa=x.allControllers[y];aa.updatePollingParamsCommentas(z);},registerMoreCommentsLinkHandler:function(y,z){var aa=x.allControllers[y];aa.registerMoreCommentsLinkHandler(z);},replaceContentMaybe:function(y,z){var aa=l.scry(document.documentElement,y)[0];if(aa)l.replace(aa,z);},notifyCommentCreated:function(y){if(!x.mainController.channel)return;q.send({type:'commentCreated',href:y.href,parentCommentID:y.parentCommentID,commentID:y.commentID});},notifyCommentRemoved:function(y){if(!x.mainController.channel)return;q.send({type:'commentRemoved',href:y.href,commentID:y.commentID});},markAsShowingAllReplies:function(y){var z=y+' a.fbUpDownVoteOption',aa=l.scry(document.documentElement,z),ba=y+' li.fbUpDownVoteOption a.itemAnchor',ca=l.scry(document.documentElement,ba),da=aa.concat(ca);for(var ea=0;ea<da.length;ea++){var fa=da[ea],ga=new r(fa.getAttribute('ajaxify'));ga.addQueryData({show_all_replies:1});fa.setAttribute('ajaxify',ga.toString());}},setLoggedIn:function(y){x.mainController.loggedIn=y;}});u(x.prototype,{isControllingModerationQueue:function(){var y=this==x.mainController&&this.inModerationQueue;return y;},resetController:function(){this.commentIDs=[];this.domIDs=[];},updateController:function(y,z,aa,ba,ca,da){y.forEach(function(fa){this.commentIDs.push(fa);},this);z.forEach(function(fa){this.domIDs.push(fa);},this);u(this.blacklistedActors,ba);for(var ea in ca){if(!this.actorToCommentInfoMap[ea])this.actorToCommentInfoMap[ea]=[];ca[ea].forEach(function(fa){this.actorToCommentInfoMap[ea].push(fa);},this);}this.newestCommentTimestamp=Math.max(this.newestCommentTimestamp,aa);u(this.commentInfoMap,da);this.attachClickHandlers();},updatePollingParamsCommentas:function(y){this.realTimePollingParams.commentas=y;},attachClickHandlers:function(){for(var y=0;y<this.domIDs.length;y++){var z='li[id="'+this.domIDs[y]+'"]',aa=l.scry(this.controlledRegion,z);if(aa.length===0)continue;var ba=aa[0],ca=l.scry(ba,'a.uiCloseButton');m.listen(ba,'mouseleave',this.closeStickyMenuFlyouts.bind(this,ca));var da=l.scry(ba,'.fbModerateDropdownContainer');if(da.length>0){var ea=da[0],fa=l.find(ea,'.fbModerateDropdownLink');m.listen(fa,'mouseover',function(oa,event){k.addClass(oa,'fbUnderlineText');}.curry(fa));m.listen(fa,'mouseout',function(oa,event){k.removeClass(oa,'fbUnderlineText');}.curry(fa));var ga=l.find(ea,'.fbModerationDropdownList');m.listen(fa,'click',this.exposeDropDownMenu.bind(this,fa,ga));m.listen(ga.parentNode,'mouseleave',this.concealDropDownMenu.bind(this,fa,ga));this.attachDropDownHandlers(ba,this.commentIDs[y],ga);}var ha=this.commentInfoMap[this.commentIDs[y]].actor,ia=!!this.recentlyBlacklistedActors[ha];if(ia){var ja=l.scry(ba,'.fbUndoBlacklistLink');if(ja.length>0){var ka=ja[0];m.listen(ka,'click',this.toggleBlackListAndSync.bind(this,this.commentIDs[y]));}}}var la=l.scry(this.controlledRegion,'.fbReplyButton'),ma=l.scry(this.controlledRegion,'.fbReplyAfterLoginButton');for(var na=0;na<la.length;na++)if(this.loggedIn){k.show(la[na]);k.hide(ma[na]);}else{k.hide(la[na]);k.show(ma[na]);}},closeStickyMenuFlyouts:function(y,event){p.hide();for(var z=0;z<y.length;z++)y[z].blur();},attachDropDownHandlers:function(y,z,aa){var ba=l.scry(aa,'.fbBanUser');if(ba.length>0){var ca=ba[0],da=l.find(ca,'^.fbFeedbackPost');if(w(da.id,z))m.listen(ca,'click',this.toggleBlackListAndSync.bind(this,z));}},exposeDropDownMenu:function(y,z,event){if(k.shown(z))return this.concealDropDownMenu(y,z,event);m.stop(event);k.show(z);z.focus();y.blur();var aa=l.find(document.documentElement,'.commentContent'),ba=s.getElementPosition(z).y+s.getElementDimensions(z).y-s.getElementDimensions(aa).y;if(ba>0){ba=ba+2;this.menuBuffer=l.create('div',{className:'menuBuffer',style:{height:ba+'px'}});l.appendContent(aa,this.menuBuffer);}return false;},concealDropDownMenu:function(y,z,event){m.stop(event);k.removeClass(y,'fbUnderlineText');k.hide(z);y.blur();if(this.menuBuffer){l.remove(this.menuBuffer);delete this.menuBuffer;}return false;},registerMoreCommentsLinkHandler:function(y){var z=y.pager_id;if(!v(z))return;var aa=t(z);m.listen(aa,'click',this.fetchMoreComments.bind(this,y,aa));},deselectComments:function(y){for(var z=0;z<y.length;z++)delete this.selectedCommentsMap[y[z]];},registerModeratorQueueHandlers:function(y){if(y)this.selectedCommentsMap={};this.selectableComments=this.findSelectableComments();this.selectableCheckboxes=[];this.selectAllCheckBoxes=l.scry(this.controlledRegion,'.fbSelectAllCheckbox');this.approveButtons=l.scry(this.controlledRegion,'.fbApproveButton');this.removeButtons=l.scry(this.controlledRegion,'.fbRemoveButton');for(var z=0;z<this.selectableComments.length;z++){var aa=this.selectableComments[z].id,ba=!!this.selectedCommentsMap[aa];this.setCommentSelection(this.selectableComments[z],ba);var ca=l.find(this.selectableComments[z],'.fbCommentCheckbox');m.listen(ca,'click',this.toggleCommentSelection.bind(this));m.listen(this.selectableComments[z],'click',this.toggleCommentSelection.bind(this));ca.checked=ba;this.selectableCheckboxes.push(ca);}for(var da=0;da<this.selectAllCheckBoxes.length;da++){this.selectAllCheckBoxes[da].checked=false;this.selectAllCheckBoxes[da].disabled=this.selectableComments.length===0;m.listen(this.selectAllCheckBoxes[da],'click',this.toggleSelectAllCheckbox.bind(this,this.selectAllCheckBoxes[da]));}for(var ea=0;ea<this.approveButtons.length;ea++)m.listen(this.approveButtons[ea],'click',this.setBulkPrivacy.bind(this,false));for(var fa=0;fa<this.removeButtons.length;fa++)m.listen(this.removeButtons[fa],'click',this.setBulkPrivacy.bind(this,true));},findSelectableComments:function(){var y=l.scry(this.controlledRegion,'.fbTopLevelComment'),z=[];for(var aa=0;aa<y.length;aa++)if((l.scry(y[aa],'.fbCommentCheckbox').length===1)&&(l.scry(y[aa],'.fbCommentOverlay').length===0))z.push(y[aa]);return z;},toggleCommentSelection:function(event){var y={a:true},z=event.getTarget(),aa=z.tagName.toLowerCase(),ba=z.parentNode.tagName.toLowerCase();if(y[aa]||y[ba])return;var ca=k.hasClass(z,'fbFeedbackPost')?z:l.find(z,'^.fbFeedbackPost'),da=this.commentIsSelected(ca),ea=!da;this.setCommentSelection(ca,ea);this.synchronizeModeratorQueueUI();if(k.hasClass(z,'fbCommentCheckbox'))m.stop(event);},commentIsSelected:function(y){return k.hasClass(y,'fbCommentSelected');},setCommentSelection:function(y,z){if(z){this.selectComment(y);}else this.deselectComment(y);},selectComment:function(y){k.addClass(y,'fbCommentSelected');this.selectedCommentsMap[y.id]=true;l.find(y,'.fbCommentCheckbox').checked=true;},deselectComment:function(y){k.removeClass(y,'fbCommentSelected');delete this.selectedCommentsMap[y.id];l.find(y,'.fbCommentCheckbox').checked=false;},toggleSelectAllCheckbox:function(y,event){m.stop(event);var z=y.checked;for(var aa=0;aa<this.selectableComments.length;aa++){this.setCommentSelection(this.selectableComments[aa],y.checked);this.selectableCheckboxes[aa].checked=z;}this.synchronizeBulkModerationCheckboxes(z);this.synchronizeBulkModerationButtons(z);},synchronizeModeratorQueueUI:function(){var y=0;for(var z=0;z<this.selectableCheckboxes.length;z++)if(this.selectableCheckboxes[z].checked)y++;var aa=this.selectableCheckboxes.length>0&&y==this.selectableCheckboxes.length;this.synchronizeBulkModerationCheckboxes(aa);this.synchronizeBulkModerationButtons(y>0);},synchronizeBulkModerationCheckboxes:function(y){for(var z=0;z<this.selectAllCheckBoxes.length;z++)this.selectAllCheckBoxes[z].checked=y;},synchronizeBulkModerationButtons:function(y){for(var z=0;z<this.approveButtons.length;z++)i.setEnabled(this.approveButtons[z],y);for(var aa=0;aa<this.removeButtons.length;aa++)i.setEnabled(this.removeButtons[aa],y);},setBulkPrivacy:function(y,event){m.stop(event);this.synchronizeBulkModerationButtons(false);var z=[];for(var aa in this.selectedCommentsMap)z.push(aa);var ba={is_private:y,in_moderation_queue:true,comment_ids:z,uniqids:z,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new h().setURI('/ajax/connect/comments/set_bulk_private.php').setData(ba).send();return false;},toggleBlackListAndSync:function(y,event){m.stop(event);var z=this.commentInfoMap[y].actor,aa={blacklist:!this.blacklistedActors[z],in_moderation_queue:this.inModerationQueue,comment_id:y,other_comment_ids:this.getOtherCommentsByActor(z,y),uniqid:y,controller_id:this.controllerID,locale:this.locale,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new h().setURI('/ajax/connect/comments/set_blacklist.php').setData(aa).setHandler(function(ba){this.blacklistedActors[z]=!this.blacklistedActors[z];if(this.blacklistedActors[z]){this.recentlyBlacklistedActors[z]=true;}else delete this.recentlyBlacklistedActors[z];}.bind(this)).send();return false;},getOtherCommentsByActor:function(y,z){return this.actorToCommentInfoMap[y].filter(function(aa){return aa!=z;});},fetchMoreComments:function(y,z,event){m.kill(event);k.addClass(z,'async_saving');if(this.fetchMoreCommentsIsPending[y.pager_id]===true)return;this.fetchMoreCommentsIsPending[y.pager_id]=true;var aa={is_reply_thread:false,in_moderation_queue:false,view_as_moderator:false};u(aa,y);aa.offset=this.getVisibleCommentCount(aa);if(!aa.aggregate_view)delete aa.aggregate_view;if(!aa.comment_id)delete aa.comment_id;if(!aa.is_reply_thread)aa.comment_ids=this.commentIDs;if(!aa.commentas){var ba=x.allControllers[aa.controller_id];aa.commentas=ba.realTimePollingParams.commentas;}new h().setURI('/ajax/connect/feedback.php').setReadOnly(true).setData(aa).setHandler(function(ca){this.fetchMoreCommentsIsPending[y.pager_id]=false;}.bind(this)).send();},getVisibleCommentCount:function(y){var z=this.getCommentsSelector(y),aa=this.getCollapsedCommentsSelector(y),ba=l.scry(t(y.controller_id),z);ba=ba.concat(l.scry(t(y.controller_id),aa));var ca=0;for(var da=0;da<ba.length;da++)if(!k.hasClass(ba[da],'fbCommentIgnored'))ca++;return ca;},getCommentsSelector:function(y){var z=y.is_reply_thread?'li.fbCommentReply':'li.fbTopLevelComment';if(y.controller_id!=y.uniqid)z='div[id="'+y.uniqid+'"] '+z;return z;},getCollapsedCommentsSelector:function(y){var z=y.is_reply_thread?'div.fbCommentReply':'div.fbTopLevelComment';if(y.controller_id!=y.uniqid)z='div[id="'+y.uniqid+'"] '+z;return z;},getRecentlyBlacklistedActors:function(){var y=[];for(var z in this.recentlyBlacklistedActors)y.push(z);return y;},attachContextualDialogHandlers:function(){this.documentClickListener=m.listen(document.documentElement,'click',this.closeContextualDialog.bind(this));},closeContextualDialog:function(event){var y=event.getTarget(),z=o.byClass(y,'fbCommentContext');if(!z)this.destroyContextualDialog();},destroyContextualDialog:function(){this.documentClickListener.remove();delete this.documentClickListener;var y=this.controllerID;n.closeContextualDialog(y);},appendComments:function(y,z){var aa=v(y);if(!aa)return;var ba=l.scry(aa,'.fbFeedbackReplies')[0];if(!ba)return;l.appendContent(ba,z);},prependComments:function(y,z){var aa=l.scry(document.documentElement,y)[0];if(!aa)return;var ba=z.getNodes(),ca=[];for(var da=ba.length;da-->0;){var ea={id:l.getID(ba[da]),element:ba[da]};ca.push(ea);var fa=v(ea.id);if(fa){k.hide(ea.element);this.duplicateComments.push(ea.element);for(var ga=0;ga<ca.length;++ga)l.insertAfter(fa,ca[ga].element);ca=[];}}for(da=0;da<ca.length;++da)l.prependContent(aa,ca[da].element);setTimeout(this.removeDuplicateComments.bind(this),0);},removeDuplicateComments:function(){for(var y=0;y<this.duplicateComments.length;++y)l.remove(this.duplicateComments[y]);this.duplicateComments=[];},pollForComments:function(y){var z={locale:this.locale};u(z,y);if(!z.is_reply_thread)z.comment_ids=this.commentIDs;z.newest_comment_timestamp=this.newestCommentTimestamp;var aa=this.handlePollResponse.bind(this),ba=this.handlePollError.bind(this),ca=this.handlePollFinally.bind(this);new h().setURI('/plugins/comments/poll').setReadOnly(true).setData(z).setMethod('GET').setHandler(aa).setErrorHandler(ba).setFinallyHandler(ca).send();},handlePollResponse:function(y){},handlePollError:function(y){},handlePollFinally:function(y){}});e.exports=window.CommentAdminPanelController||x;});
__d("ConnectLogin",["PopupWindow","URI","WindowComm","XD"],function(a,b,c,d,e,f){var g=b('PopupWindow'),h=b('URI'),i=b('WindowComm'),j=b('XD').XD,k={init:function(l){this.appID=l.appID;this.addToProfile=l.addToProfile;this.channelUrl=l.channelUrl;j.init(l);},login:function(l,m,n){this._openPopup(l,m,n);},logout:function(){j.send({type:'logout'});},_openPopup:function(l,m,n){n=n||{};var o=i.makeHandler(function(s){k._closePopup();if(k.appID)k._refreshLoginStatus();l&&l();}),p=i.makeHandler(function(s){k._closePopup();}),q=new h('/login.php');q.setQueryData({api_key:this.appID,next:o,channel_url:p,cancel_url:p,req_perms:m,v:'1.0',fbconnect:1,add_to_profile:this.addToProfile,display:'popup'});q.addQueryData(n);var r=this._getSize(n);this._popup=g.open(q.toString(),r.height,r.width);},_closePopup:function(){if(this._popup){this._popup.close();this._popup=null;}},_refreshLoginStatus:function(){if(this.channelUrl){j.send({type:'refreshLoginStatus'});}else window.location.reload();},_getSize:function(l){if(l.social_plugin=='registration'){return {width:640,height:370};}else return {width:610,height:280};}};e.exports=k;});
__d("legacy:feedback",["Feedback"],function(a,b,c,d){a.Feedback=b('Feedback');},3);
__d("ReferrerTools",[],function(a,b,c,d,e,f){e.exports.storeAncestorOrigins=function(g){for(var h=0;h<location.ancestorOrigins.length;h++){var i=document.createElement('input');i.type='hidden';i.name='ancestor_origins[]';i.value=location.ancestorOrigins.item(h);g.appendChild(i);}};});
__d("SubscriptionFlyoutController",["Arbiter","CSS","DataStore","EditSubscriptions","Hovercard","HoverFlyout","$","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('EditSubscriptions'),k=b('Hovercard'),l=b('HoverFlyout'),m=b('$'),n=b('cx'),o=b('emptyFunction'),p=null,q,r,s,t=['uiButtonConfirm','uiButtonSpecial',"_42gz","_42g-","_4jy2","_51tl","_4jy1"];function u(y){for(var z=0;z<t.length;z++)if(h.hasClass(y,t[z]))return false;return true;}function v(y,z){s=i.get(z,'profile_id');var aa=i.get(z,'loc');j.init(r,s,aa);if(u(z)){h.addClass(z,"_52nd");if(h.hasClass(z,'uiButton')||h.hasClass(z,"_42fu"))h.addClass(z,'selected');}if(i.get(z,'onclose'))clearTimeout(i.remove(z,'onclosetimeout'));}function w(y,z){s=null;if(u(z)){h.removeClass(z,'uiButtonHover');if(h.hasClass(z,'uiButton')||h.hasClass(z,"_42fu"))h.removeClass(z,'selected');}if(i.get(z,'onclose'))i.set(z,'onclosetimeout',function(){var aa=i.remove(z,'onclose');aa&&aa();}.defer(1500));}var x={init:function(y,z){x.init=o;q=y;r=m(z);p=new l();p.init(y);p.setShowDelay(100).setHideDelay(150);p.subscribe('show',v);p.subscribe('hide',w);g.subscribe(['UnfollowUser','UnfollowingUser'],function(aa,ba){if(!ba.from_hide_flyout&&ba.profile_id==s){if(k.contains&&q)if(k.contains(q.getContext()))k.hide();p.hideFlyout(true);}});g.inform('SubscriptionFlyoutController/initialized',null,g.BEHAVIOR_PERSISTENT);},initNode:function(y,z,aa){i.set(y,'profile_id',z);i.set(y,'loc',aa);p.initNode(y);h.addClass(y,"_52nf");},setActiveNode:function(y){p.setActiveNode(y);},show:function(y){p.showFlyout(y,true);},setCloseListener:function(y,z){if(p.getActiveNode()!==y){z();}else i.set(y,'onclose',z);}};e.exports=a.SubscriptionFlyoutController||x;});
__d("FollowButton",["Event","Arbiter","AsyncRequest","Button","CSS","DOM","FriendListFlyoutController","SubscriptionFlyoutController","SubscriptionLevels","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Button'),k=b('CSS'),l=b('DOM'),m=b('FriendListFlyoutController'),n=b('SubscriptionFlyoutController'),o=b('SubscriptionLevels'),p=b('URI'),q=b('copyProperties'),r=14;function s(w,x,y){k.conditionShow(x,y);k.conditionShow(w,!y);}function t(w,x){if(x&&k.hasClass(w,'enableFriendListFlyout')){m.show(w);}else m.hide();}function u(w,x,y){var z=l.scry(w,'.lowIcon')[0],aa=l.scry(w,'.medIcon')[0],ba=l.scry(w,'.highIcon')[0];if(!z||!aa||!ba)return;h.subscribe('SubscriptionLevelUpdated',function(ca,da){if(y===da.profile_id)switch(da.level){case o.ALL:j.setIcon(x,ba);break;case o.DEFAULT:j.setIcon(x,aa);break;case o.TOP:j.setIcon(x,z);break;}});}function v(w,x,y,z,aa,ba){this.init(w,x,y,z,aa,ba);}q(v.prototype,{init:function(w,x,y,z,aa,ba){h.subscribe('SubscriptionFlyoutController/initialized',this._init.bind(this,w,x,y,z,aa,ba));},_init:function(w,x,y,z,aa,ba){if(!k.hasClass(y,'enableFriendListFlyout'))n.initNode(y,z,aa);if(aa==r&&k.shown(y))n.show(y);g.listen(x,'click',function(){s(x,y,true);n.setActiveNode(y);var ea=new p(x.getAttribute('ajaxify')),fa={profile_id:z,location:aa,source:'follow-button',subscribed_button_id:y.id,xids:ea.getQueryData().xids};new i().setURI(ba).setData(fa).setRelativeTo(y).send();});w&&u(w,y,z);h.subscribe(['FollowUser','FollowingUser','UnfollowUser','UnfollowingUser'],function(ea,fa){if(fa.profile_id==z)s(x,y,ea=='FollowUser'||ea=='FollowingUser');t(y,ea=='FollowUser');});var ca=false;h.subscribe('UnfollowingUser',function(ea,fa){if(fa.profile_id==z){ca=k.shown(y);ca&&s(x,y,false);}});h.subscribe('UnfollowUserFail',function(ea,fa){if(fa.profile_id==z&&ca)s(x,y,true);});h.subscribe('FollowUserFail',function(ea,fa){if(fa.profile_id==z&&ca)s(x,y,false);});var da=false;h.subscribe(['FriendRequest/sending','FriendRequest/confirming'],function(ea,fa){if(fa.uid==z){da=k.shown(x);da&&s(x,y,true);}});h.subscribe(['FriendRequest/sendFail','FriendRequest/confirmFail'],function(ea,fa){if(fa.uid==z&&da)s(x,y,false);});h.subscribe('FriendRequest/unfriend',function(ea,fa){(fa.uid==z)&&s(x,y,false);});}});e.exports=a.FollowButton||v;});
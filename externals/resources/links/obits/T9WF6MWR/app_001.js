(function(e,t){"use strict";var n=e.NYTD||{};n.Video=n.Video||{},n.Video.HomepagePlaylistId=n.Video.HomepagePlaylistId||1194811622188;var r={},i=e.location.href.split("?");i=i.length>=2?i[1]:i[0],i.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,i){t&&i&&(r[t]=i)});var s="cE97ArV7TzqBzkmeRVVhJ8O6GWME2iG_bRvjBTlNb4o.",o=r.videoId,u=r.playlistId||n.Video.HomepagePlaylistId||1194811622349,a=r.autoStart||!1,f=r.autoRender||!0,l=r.playerType||"homepage",c=r.playerId||"2028569413001",h=r.hideTopLinks||!1,p=r.showLongDesc||!0,d=r.width||312,v=r.height||176,m=r.adxPagename||"www.nytimes.com/pages/video",g=r.maxItems||4,y=r.header||!0,b=[],w=[],E=null,S=[],x=null,T=0,N=!1,C=!1,k=null,L=null,A=null,O=null,M=0,_=!0,D=!1,P=0,H=null,B=null,j=null,F=null,I=null,q=null,R=null,U=null,z=null,W=null,X="http://js.nyt.com",V=!0,$="production",J=t("#videoplayerModule");e&&e.location&&e.location.host&&(e.location.host.indexOf(".dev")!==-1?($="development",X="http://static.dev.nytimes.com",V=!1):e.location.host.indexOf(".stg")!==-1&&($="staging",X="http://static.stg.nytimes.com",V=!1));var K=function(){y==="false"&&J.addClass("noHeader")},Q=function(){switch(l){case"homepage":d=312,v=176,J.addClass("playerTypeHomepage");break;case"article":d=318,v=179,J.addClass("playerTypeArticle");break;case"section":d=395,v=223,g=5,J.addClass("playerTypeSection");break;case"blog":d=474,v=267,J.addClass("playerTypeBlog")}J.show()},G=function(e){var t=/nyto_([^,]+)/.exec(e.tags.join(","));t&&t.length>=2&&S.push(t[1])},Y=function(e){q&&e&&e.customFields&&(q.data("title",e.name),q.data("description",e.longDescription),q.data("url",e.customFields.videourl||"http://www.nytimes.com/video"))},Z=function(e){var n=t("#videoplayerMenu .videoThumb").eq(e);x&&x.removeClass("selected"),n.addClass("selected"),x=n},et=function(e){var n=w[e];if(n){var r=n.name||n.displayName||"";if(r){var i=t(document.createElement("a"));i.attr({href:n.customFields.videourl,title:r,alt:r,target:"_blank"}).html(r),j.html(i)}var s=p?n.longDescription:n.shortDescription;F.html(s||"")}S&&e<S.length&&B.html(S[e]||"")},tt=function(e){B.show(),j.show(),F.show()},nt=function(e){k&&w&&(Y(w[e]),e>=0&&e<w.length&&(T=e,k.loadVideo(w[e].referenceId,"referenceId"),et(e),Z(e)))},rt=function(){U.hide()},it=function(){U.show()},st=function(){R.hide()},ot=function(){D&&R.show()},ut=function(){W.addClass("hidden")},at=function(){W.removeClass("hidden")},ft=function(){var e=t(document.createElement("div"));I=t(document.createElement("h6"));var n=t(document.createElement("em")),r=t(document.createElement("div"));r.addClass("underadnotice"),n.text("YOUR VIDEO WILL START IN 15 SECONDS."),e.addClass("adnoticewrapper"),e.append(I),e.append(r),I.addClass("adnotice"),I.append("ADVERTISEMENT "),I.append(n),H=e},lt=function(){z=t("div.videoplayerContainer > div.container > div.inset > div.videoContainer"),R=t(".videoNowPlayingNotice"),U=t("div.videoplayerContainer .spinner"),B=t("div.videoplayerContainer #sectionName"),j=t("div.videoplayerContainer #videoTitle"),F=t("div.videoplayerContainer #videoShortDesc"),q=t("div.videoplayerContainer div.videoShareToolsContainer div.shareTools"),W=t("div.videoplayerContainer > div.container > div.inset > div.screenCover"),ft()},ct=function(e){mt()?C&&(N||E.play()):(w.push(k.getCurrentVideo()),rt(),G(w[0]),et(0),tt(),Y(w[0]))},ht=function(e){O.isMenuPageShowing()&&O.closeMenuPage(),M=L.getCurrentAdProperties().duration,st(),_&&z&&z.prepend(H),bt()},pt=function(e){_&&H.remove()},dt=function(){ot()},vt=function(e){bt()},mt=function(){return!o&&u},gt=function(e){if(e.obj.position>=0){var t=parseInt(M-Math.floor(e.obj.position),10);t>=0&&(t<10&&(t=["0",t].join("")),I.html(["ADVERTISEMENT <em>YOUR VIDEO WILL START IN ",t," SECONDS.</em>"].join("")))}},yt=function(){st();var e=x.next();if(e&&e.length>0){var n=t(e).index();nt(n)}else N=!0,E.stop(),at()},bt=function(){C||(x===null&&(Z(0),et(0)),C=!0)},wt=function(e){return typeof e=="string"&&e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e},Et=function(){for(var e=0,n=w.length;e<n;e++){var r=w[e],i=e===0?" firstThumb":"",s=['<li class="videoThumb',i,' containingBlock">','<img src="',r.thumbnailURL,'" width="75" height="50" alt="',wt(r.name),'">','<div class="videoThumbOverlay"></div>','<div class="videoThumbPlayOverlay kicker">Play</div>','<div class="kicker section">',S[e],"</div>",'<div class="videoThumbPointerIcon"></div>',"</li>"].join("");t("#videoplayerMenu").append(s)}mt()&&(et(0),tt(),Y(w[0]),Z(0))},St=function(){var e=function(e){if(t(this).index()!==T||!C)T=t(this).index(),nt(T),t(this).find(".playOverlay").first().html("Playing");C||(C=!0),_&&H.remove(),t(W).hasClass("hidden")||ut()},n=function(e){var n=t(this).index();if(C&&t(this).index()===T)return;t(this).find(".playOverlay").first().html("Play"),x&&(x.removeClass("selected"),n!==T&&st()),t(this).addClass("selected"),et(n),Z(n)},r=function(e){t(this).removeClass("selected"),C?(et(T),Z(T)):(et(0),Z(0)),x&&k&&k.isPlaying()&&ot()};t(document).delegate(".videoThumb","click touch",e),t(document).delegate(".videoThumb","mouseenter",n),t(document).delegate(".videoThumb","mouseleave",r)},xt=function(){E=n.Video.Factory.create({container:"videoContainerWrapper",bigAdContainer:"",id:[c,(new Date).getTime().toString()].join(""),playerId:c,videoId:b.shift(),publisherId:"1749339200",width:d,height:v,autoStart:a,autoRender:f,playerType:l+" iframe",quality:"high",videoIds:b,playlistId:"",autoPlayPlaylist:!1,isLive:!1,connectOnLoad:"true",enableInitialBandwidthDetection:"true",pollService:"",enableLivePoll:!1,enableHTML5Ads:!1,adxPagename:m,adxAdPositions:"VideoPlayerAd,VideoBigAd,ADX_CLIENTSIDE",loadVideoPosterAssets:!1});if(E){var e=E.getSubscription(),t=!1,r=0,i=function(e){O=E.getMenuModule(),L=E.getAdModule(),k=E.getVideoModule(),A=E.getContentModule(),Et(),St(),rt(),L&&L.enableExternalAds(!0)};e&&(e.subscribe(n.Video.VideoEvents.TEMPLATE_READY,i),e.subscribe(n.Video.VideoEvents.STREAM_START,vt),e.subscribe(n.Video.VideoEvents.VIDEO_COMPLETE,yt),e.subscribe(n.Video.VideoEvents.VIDEO_START,dt),e.subscribe(n.Video.VideoEvents.CONTENT_LOAD,ct),e.subscribe(n.Video.VideoEvents.AD_START,ht),e.subscribe(n.Video.VideoEvents.AD_COMPLETE,pt),_&&e.subscribe(n.Video.VideoEvents.AD_PROGRESS,gt))}},Tt=function(e,n){t.ajax({url:"http://api.brightcove.com/services/library",type:"get",dataType:"jsonp",data:["command=",e,"&token=",s,"&callback=",n,"&media_delivery=http","&custom_fields=related_headlines%2Crelated_type%2Cvideourl&","fields=videoIds%2Cname%2Ctags%2CdisplayName%2Cid%2CreferenceId%2CaccountId%2CshortDescription%2ClongDescription","%2CFLVURL%2Crenditions%2CcreationDate%2CpublishedDate%2ClastModifiedDate%2CstartDate","%2CendDate%2ClinkURL%2ClinkText%2Ctags%2CvideoStillURL%2CthumbnailURL%2Clength%2Ceconomics","%2CcuePoints%2CplaysTotal%2CplaysTrailingWeek%2CFLVFullLength%2CvideoFullLength&get_item_count=true&page_size=",g].join(""),cache:!0,jsonp:!0,jsonpCallback:n})},Nt=function(){var t=["embed_2_",u,(new Date).getTime()].join("");e[t]=function(t){var n=t.videoIds.length,r=[];for(var i=0;i<g;i++)r.push(t.videoIds[i]);var s=["embed_3_",u,(new Date).getTime()].join("");e[s]=function(e){w=e.items;var t=null;for(var n=0,r=w.length;n<r;n++)t=w[n],G(t),b.push(t.referenceId);xt()},Tt(["find_videos_by_ids&video_ids=",r.join(",")].join(""),s)},Tt(["find_playlist_by_reference_id&reference_id=",u].join(""),t)},Ct=function(){K(),Q(),lt(),mt()?Nt():(b.push(o),xt())};t(function(){Ct(),(h==="1"||h==="true")&&n.jQuery("div.videoplayerModuleHeader > div.inset > div.opposingFloatControl > div.element2 > ul.horizontalMenu").hide()})})(window,NYTD.Video.$);
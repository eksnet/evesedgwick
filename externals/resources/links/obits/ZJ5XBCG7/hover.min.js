$(document).ready(function($){function getClientWidth(){return document.compatMode=='CSS1Compat'&&!window.opera?document.documentElement.clientWidth:document.body.clientWidth;}

function getClientHeight(){return document.compatMode=='CSS1Compat'&&!window.opera?document.documentElement.clientHeight:document.body.clientHeight;}

$(function(){var hideDelay=0;var hideTimer=null;var x;var showDelay=1000*ajax_delay;var container=$('<div id="popupContainer"><table width="" border="0" cellspacing="0" cellpadding="0" align="center" class="popupBubble"><tr><td class="corner topLeft"></td><td class="top"></td><td class="corner topRight"></td></tr><tr><td class="left"> </td><td><div id="popupContent"></div></td><td class="right"> </td></tr><tr><td class="corner bottomLeft"> </td><td class="bottom"> </td><td class="corner bottomRight"></td></tr></table></div>');$('body').append(container);$('.avatar').live('mouseover',function(){var elem_var=String($(this).attr('rel')).split('_');var elemType=elem_var[0];var elemID=elem_var[1];if(!elemID)return;if(hideTimer)

clearTimeout(hideTimer);var pos=$(this).offset();var width=$(this).width();$.data(this,'timer',setTimeout(function(){var right=getClientWidth()-pos.left-width;var boxWidth=$('div#popupContainer').width();if(boxWidth<right){container.css({left:(pos.left+width)+'px',top:pos.top-5+'px'});}else{container.css({left:(pos.left-boxWidth)+'px',top:pos.top-5+'px'})}

container.css('display','block');var loading='<img src="'+ajax_image+'/ajax-loader.gif" alt="Loading" />';$('div#popupContent').html(loading);if(x){x.abort();x=null;}

x=$.ajax({type:'GET',url:ajax_url,data:{ID:elemID,type:elemType,action:'cd_ab_the_avatardata'},success:function(data){if(data.indexOf(elemID)>0){var text=$(data).html();$('div#popupContent').html(text);var right=getClientWidth()-pos.left-width;var boxWidth=$('div#popupContainer').width();if(boxWidth<right){container.css({left:(pos.left+width)+'px',top:pos.top-5+'px'});}else{container.css({left:(pos.left-boxWidth)+'px',top:pos.top-5+'px'})}

container.css('display','block');}}});},showDelay));}).live('mouseout',function(){clearTimeout($.data(this,'timer'));});$('.avatar').live('mouseout',function(){if(hideTimer)

clearTimeout(hideTimer);hideTimer=setTimeout(function(){if(x){x.abort();x=null;}

container.css('display','none');},hideDelay);});$('#popupContainer').mouseover(function(){if(hideTimer)

clearTimeout(hideTimer);});$('#popupContainer').mouseout(function(){if(hideTimer)

clearTimeout(hideTimer);hideTimer=setTimeout(function(){if(x){x.abort();x=null;}

container.css('display','none');},hideDelay);});});});

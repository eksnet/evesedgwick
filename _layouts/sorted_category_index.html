---
layout: base
---
<!-- listing of all Categories under Nav-->
    {% if page.category == 'all' %}
        <section id='title'>    
            <h2>{{ page.nav | category_link}}</h2>
            <ul class='nav' id='sub-nav'>
            {% for nav in site.navs_by_category[page.nav] %}
                {% for category in nav %}
                    <li>{{ category.name | category_link }}</li>   
                {% endfor %}
            {% endfor %}
            </ul>
        </section>
        
        {% for nav in site.navs_by_category[page.nav] %}
            {% for category in nav %}
                <h2 class='subsection'><span>{{ category['name'] | category_link }}</span></h2>
                {% for post in category['posts'] %}
                    {% assign record_count = forloop.length %}
                {% endfor %}
                <div class='marginal record_count'> 
                    {{ record_count }} Records
                </div>
                {% for setting in site.category-settings %}
                    {% if setting.category == category.name %}
                        <p class='intro'>{{ setting.description }}</p>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    {% else %}
        <!-- Title block - Nav/Category -->

        {% if page.sub == 'all' %}
        <section id='title'>    
            <h2 style=''>{{ page.nav | category_link }} <span>{{ page.category | category_link}}</span></h2>
            <ul class='nav' id='sub-nav'>
            {% for category in site.categories_by_sub[page.category] %}
                {% for sub in category %}
                    <li>{{ sub.name | sub_category_link: page.category }}</li>   
                {% endfor %}
            {% endfor %}
            </ul>
        </section>
        <!-- endTitle -->
        {% else %}
        {% for category in site.categories_by_sub[page.category] %}
            {% for sub in category %}
            {% if page.sub == sub.name %}
            <!-- Title block - Nav/Category/Sub -->
            <section id='title'>    
                <h2 style=''>{{ page.nav | category_link }} <span>{{ page.category | category_link}}/{{ sub.name | sub_category_link: page.category }}</span></h2>
                <ul class='nav' id='sub-nav'>
                    <li><a href="/{{page.category}}/{{page.sub}}">SORT ALPHABETICALLY</a></li>   
                </ul>
            </section>
            <!-- endTitle -->
            {% endif %}
            {% endfor %}
            {% endfor %}
        {% endif %}
        
<!-- listing of all Sub-categories under Nav/Category -->
        {% for category in site.categories_by_sub[page.category] %}
            {% for sub in category %}
            {% if page.sub == 'all' %}
                <h2 class='subsection'><span>{{ sub.name | sub_category_link: page.category }}</h2>
                {% for post in sub.posts %}
                    {%assign record_count = forloop.length %}
                {% endfor %}
                <div class='marginal record_count'> 
                    {{ record_count }} Records
                </div>
                {% for setting in site.category-settings %}
                    {% if setting.category == sub.name %}
                        <p class='intro'>{{ setting.description }}</p>
                    {% endif %}
                {% endfor %}
            {% else %}
            {% if page.sub == sub.name %}
                {% for sub in site.sub-categories_by_tag[page.sub] %}
                <div class='marginal toc'>
                {% for tag in sub %}
                    {% assign anchor = forloop.index %}
                    {% for post in tag.posts %}
                        {% assign record_count = forloop.length %}
                    {% endfor %}
                    <a href='#{{anchor}}'><span class='heading'>{{tag.name | upcase }}</span> {{ record_count }} Records</a><br>                    
                {% endfor %}
                </div>
                {% endfor %}
                {% for sub in site.sub-categories_by_tag[page.sub] %}
                {% for tag in sub %}
                    {% assign anchor = forloop.index %}
                     <h2 class='subsection'><span><a href="#container" name="{{anchor}}">{{ tag.name | upcase }}</a></span></h2>
                {% for post in tag.posts %}
                <section class='preview'>
                    <h4><a href="{{ post.url }}">{{ post.title | upcase }}{% if page.category == 'writing' %} ({% if post.pub-date != 10000 %}{{post.pub-date}}{% else %} forthcoming {% endif %}){% endif %}</a></h4>
                    {% if sub.name == 'exhibitions' %}
                       <h6 style='font-size:12px; line-height:12px;'> {% if post.exhibition-location %}{{ post.exhibition-location | upcase }}, {{ post.exhibition-date }}{% endif %} </h6>
                    {% endif %}
                    <p>{{ post.description | none }}</p>
                    {% assign related = false %}
                    {% for tag in post.tags %}
                        {% assign related = true %}
                    {% endfor %}
                    {% if related %}
                        <h6>RELATED - {{ post.tags | tag_links }}</h6>
                    {% endif %}
                </section>
                {% endfor %}
                {% endfor %}
                {% endfor %}
                {% endif %}
                
            {% endif %}
            {% endfor %}

<!-- include records not grouped in sub-categories (only bibliography right now) -->
            {% if page.sub == 'all' %}
            {% for post in site.categories[page.category] %}
                {% if post.sub-category %}
                {% else %}
                    <h2 class='subsection'><span><a href="{{ post.url }}">{{ post.title | upcase }}</a></span></h2>
                {% endif %}
            {% endfor %}
            {% endif %}
            
        {% endfor %}
    {% endif %}